count(party)
survey %>%
mutate(party = fct_recode(party,
"Republican, strong"    = "Strong republican",
"Republican, weak"      = "Not str republican",
"Independent, near rep" = "Ind,near rep",
"Independent, near dem" = "Ind,near dem",
"Democrat, weak"        = "Not str democrat",
"Democrat, strong"      = "Strong democrat"
)) -> survey
survey %>%
count(reported_income)
survey %>%
mutate(reported_income = fct_relevel(reported_income,
"Lt $1000")) -> survey
survey %>%
count(reported_income)
survey %>%
count(party)
survey %>%
ggplot(aes(party)) +
geom_bar(fill = "dodgerblue4") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
survey %>%
mutate(party = fct_relevel(party,
"Democrat, strong",
"Democrat, weak",
"Independent, near dem",
"Independent",
"Independent, near rep",
"Republican, weak",
"Republican, strong")) -> survey
survey %>%
ggplot(aes(party)) +
geom_bar(fill = "dodgerblue4") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
summary(survey$year)
summary(survey$age)
summary(survey$tv_hours)
survey %>%
filter(tv_hours > 24)
survey %>%
mutate(tv_hours = ifelse(tv_hours > 24, NA, tv_hours)) -> survey
survey %>%
ggplot(aes(tv_hours)) +
geom_histogram(binwidth = 1,
color = "white", fill = "dodgerblue4") +
theme_light()
survey %>%
arrange(-tv_hours) %>%
slice(1:25) %>%
select(tv_hours, marital, age, reported_income) %>%
pander()
survey %>%
ggplot(aes("", tv_hours)) +
geom_boxplot()
knitr::opts_chunk$set(echo = TRUE, warning = F, cache = T)
library(tufte)
library(pander)
source("prepare_session.R")
knitr::opts_chunk$set(out.width = "100%",
fig.width = 6, fig.asp = 0.6, tidy='styler',
cache = T,
echo = T,
warning = F)
library(dplyr)
library(forcats)
set.seed(1)
forcats::gss_cat %>%
mutate(rincome = ordered(rincome),
rincome = fct_relevel(rincome, "Lt $1000", after = 3)) %>%
mutate(tvhours = tvhours + tvhours*6*sample(size = nrow(.), c(T,F), prob = c(0.001,0.999), replace = T)) %>%
mutate_all(as.character) %>%
saveRDS("survey.RDS")
library(ggplot2)
library(dplyr)
library(forcats)
library(mice)
survey <- readRDS("survey.RDS")
glimpse(survey)
survey <- readRDS("survey.RDS")
glimpse(survey)
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
rincome = as.factor(rincome),
partyid = as.factor(partyid),
relig = as.factor(relig),
denom = as.factor(denom),
tvhours = as.numeric(tvhours)) %>%
glimpse
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
rincome = as.factor(rincome),
partyid = as.factor(partyid),
relig = as.factor(relig),
denom = as.factor(denom),
tvhours = as.numeric(tvhours)) %>%
rename(reported_income = rincome,
party = partyid,
religion = relig,
denomination = denom,
tv_hours = tvhours) %>%
glimpse
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
reported_income = as.factor(rincome),
party = as.factor(partyid),
religion = as.factor(relig),
denomination = as.factor(denom),
tv_hours = as.numeric(tvhours)) %>%
select(-rincome:-tvhours) %>%
glimpse
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
reported_income = as.factor(rincome),
party = as.factor(partyid),
religion = as.factor(relig),
denomination = as.factor(denom),
tv_hours = as.numeric(tvhours)) %>%
select(-rincome:-tvhours) -> survey
survey %>%
duplicated %>%
summary
survey %>%
filter(duplicated(.))
survey %>%
filter(!duplicated(.))
survey %>%
distinct()
survey %>%
count(party)
survey %>%
mutate(party = fct_recode(party,
"Republican, strong"    = "Strong republican",
"Republican, weak"      = "Not str republican",
"Independent, near rep" = "Ind,near rep",
"Independent, near dem" = "Ind,near dem",
"Democrat, weak"        = "Not str democrat",
"Democrat, strong"      = "Strong democrat"
)) -> survey
survey %>%
count(reported_income)
survey %>%
mutate(reported_income = fct_relevel(reported_income,
"Lt $1000")) -> survey
survey %>%
count(reported_income)
survey %>%
count(party)
survey %>%
ggplot(aes(party)) +
geom_bar(fill = "dodgerblue4") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
survey %>%
mutate(party = fct_relevel(party,
"Democrat, strong",
"Democrat, weak",
"Independent, near dem",
"Independent",
"Independent, near rep",
"Republican, weak",
"Republican, strong")) -> survey
survey %>%
ggplot(aes(party)) +
geom_bar(fill = "dodgerblue4") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
summary(survey$year)
summary(survey$age)
summary(survey$tv_hours)
survey %>%
filter(tv_hours > 24)
survey %>%
mutate(tv_hours = ifelse(tv_hours > 24, NA, tv_hours)) -> survey
survey %>%
ggplot(aes(tv_hours)) +
geom_histogram(binwidth = 1,
color = "white", fill = "dodgerblue4") +
theme_light()
survey %>%
arrange(-tv_hours) %>%
slice(1:25) %>%
select(tv_hours, marital, age, reported_income) %>%
pander()
survey %>%
ggplot(aes("", tv_hours)) +
geom_boxplot()
survey %>%
mutate(tv_hours = ifelse(tv_hours > 8, NA, tv_hours)) -> survey
summary(survey)
md.pattern(survey)
knitr::opts_chunk$set(echo = TRUE, warning = F, cache = T)
library(tufte)
library(pander)
source("prepare_session.R")
knitr::opts_chunk$set(out.width = "100%",
fig.width = 6, fig.asp = 0.6, tidy='styler',
cache = T,
echo = T,
warning = F)
library(dplyr)
library(forcats)
set.seed(1)
forcats::gss_cat %>%
mutate(rincome = ordered(rincome),
rincome = fct_relevel(rincome, "Lt $1000", after = 3)) %>%
mutate(tvhours = tvhours + tvhours*6*sample(size = nrow(.), c(T,F), prob = c(0.001,0.999), replace = T)) %>%
mutate_all(as.character) %>%
saveRDS("survey.RDS")
library(ggplot2)
library(dplyr)
library(forcats)
library(mice)
survey <- readRDS("survey.RDS")
glimpse(survey)
survey <- readRDS("survey.RDS")
glimpse(survey)
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
rincome = as.factor(rincome),
partyid = as.factor(partyid),
relig = as.factor(relig),
denom = as.factor(denom),
tvhours = as.numeric(tvhours)) %>%
glimpse
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
rincome = as.factor(rincome),
partyid = as.factor(partyid),
relig = as.factor(relig),
denom = as.factor(denom),
tvhours = as.numeric(tvhours)) %>%
rename(reported_income = rincome,
party = partyid,
religion = relig,
denomination = denom,
tv_hours = tvhours) %>%
glimpse
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
reported_income = as.factor(rincome),
party = as.factor(partyid),
religion = as.factor(relig),
denomination = as.factor(denom),
tv_hours = as.numeric(tvhours)) %>%
select(-rincome:-tvhours) %>%
glimpse
survey %>%
mutate(year = as.integer(year),
marital = as.factor(marital),
age = as.integer(age),
race = as.factor(race),
reported_income = as.factor(rincome),
party = as.factor(partyid),
religion = as.factor(relig),
denomination = as.factor(denom),
tv_hours = as.numeric(tvhours)) %>%
select(-rincome:-tvhours) -> survey
survey %>%
duplicated %>%
summary
survey %>%
filter(duplicated(.))
survey %>%
filter(!duplicated(.))
survey %>%
distinct()
survey %>%
count(party)
survey %>%
mutate(party = fct_recode(party,
"Republican, strong"    = "Strong republican",
"Republican, weak"      = "Not str republican",
"Independent, near rep" = "Ind,near rep",
"Independent, near dem" = "Ind,near dem",
"Democrat, weak"        = "Not str democrat",
"Democrat, strong"      = "Strong democrat"
)) -> survey
survey %>%
count(reported_income)
survey %>%
mutate(reported_income = fct_relevel(reported_income,
"Lt $1000")) -> survey
survey %>%
count(reported_income)
survey %>%
count(party)
survey %>%
ggplot(aes(party)) +
geom_bar(fill = "dodgerblue4") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
survey %>%
mutate(party = fct_relevel(party,
"Democrat, strong",
"Democrat, weak",
"Independent, near dem",
"Independent",
"Independent, near rep",
"Republican, weak",
"Republican, strong")) -> survey
survey %>%
ggplot(aes(party)) +
geom_bar(fill = "dodgerblue4") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
summary(survey$year)
summary(survey$age)
summary(survey$tv_hours)
survey %>%
filter(tv_hours > 24)
survey %>%
mutate(tv_hours = ifelse(tv_hours > 24, NA, tv_hours)) -> survey
survey %>%
ggplot(aes(tv_hours)) +
geom_histogram(binwidth = 1,
color = "white", fill = "dodgerblue4") +
theme_light()
survey %>%
arrange(-tv_hours) %>%
slice(1:25) %>%
select(tv_hours, marital, age, reported_income) %>%
pander()
survey %>%
ggplot(aes("", tv_hours)) +
geom_boxplot()
survey %>%
mutate(tv_hours = ifelse(tv_hours > 8, NA, tv_hours)) -> survey
summary(survey)
md.pattern(survey)
a <- NA
b <- 1
a == NA
b == NA
survey_md %>%
ggplot(aes(reported_income, fill = age_missing)) +
geom_bar(position = "fill") +
coord_flip()
survey %>%
mutate(age_missing = is.na(age),
tv_missing = is.na(tv_hours)) -> survey_md
survey_md %>%
ggplot(aes(reported_income, fill = age_missing)) +
geom_bar(position = "fill") +
coord_flip()
survey_md %>%
ggplot(aes(reported_income, fill = tv_missing)) +
geom_bar(position = "fill") +
coord_flip()
survey_md %>%
ggplot(aes(party, fill = tv_missing)) +
geom_bar(position = "fill") +
coord_flip()
survey_md %>%
ggplot(aes(tv_missing, age, color = tv_missing)) +
geom_boxplot()
library(tidyr)
library(readr)
library(purrr)
survey %>%
mutate(row = 1:n()) %>%
gather(key, value, -row) %>%
sample_frac(0.99) %>%
spread(key, value) %>%
select(-row) %>%
mutate_all(parse_guess) %>%
mutate_if(negate(is.numeric), as.factor) -> survey2
summary(survey2)
survey2 %>%
ggplot(aes(religion)) +
geom_bar() +
coord_flip()
survey2 %>%
group_by(religion) %>%
summarize(frequency = n()) %>%
mutate(relative_frequency = frequency/sum(frequency)) %>%
arrange(-frequency) %>%
pander
x <- c(5, 6, 12, NA, 43)
mean(x)
sum(x)
survey %>%
select(age, tv_hours) %>%
cor(na.rm = T)
survey2 %>%
select(age, tv_hours) %>%
na.omit() %>%
nrow()
survey2 %>%
na.omit() %>%
select(age, tv_hours) %>%
nrow()
library(ggthemes)
survey %>%
ggplot(aes(party, fill = party_group)) +
geom_bar() +
facet_grid(fct_rev(party_group)~., scales = "free", space = "free") +
coord_flip() +
scale_fill_tableau()
survey %>%
ggplot(aes(marital, age)) +
geom_boxplot()
knitr::include_graphics("images/operations2.png", dpi = NA)
tidy_who %>%
filter(country == "Belgium") %>%
group_by(year) %>%
summarize(n_cases = sum(cases, na.rm = T))
cat("\"",as.character(today()), "\"",  " - \"1991-06-28\"", sep = "")
lubridate
library(lubridate)
cat("\"",as.character(today()), "\"",  " - \"1991-06-28\"", sep = "")
now()
Sys.timezone()
now() %>% with_tz("UTC")
library(dplyr)
now() %>% with_tz("UTC")
period(days = 2, minutes = 4, seconds = 70)
days(1) + hours(1)
duration(days = 2, minutes = 4, seconds = 70)
2*24*3600+4*60+70
ddays(-10)
duration(days = 1:5, hours = 3:7)
ddays(0:6)
today()
today() + ddays(1:6)
ymd("2019-01-01") + years(2)
ymd("2019-01-01") + dyears(2)
ymd_hms("2019-03-30 16:00:00", tz = "CET") + days(1)
ymd_hms("2019-03-30 16:00:00", tz = "CET") + ddays(1)
ymd(20190131) + months(0:11)
ymd(20190131) %m+% months(0:11)
wilde <- interval(mdy(10161854), mdy(11301900))
wilde
hugo <- interval(mdy(02261802), mdy(05221885))
hugo
class(hugo)
int_overlaps(hugo, wilde)
intersect(hugo, wilde)
union(hugo, wilde)
dplyr::union(hugo, wilde)
dplyr::intersect(hugo, wilde)
lubridate::union(hugo, wilde)
lubridate::intersect(hugo, wilde)
dplyr::union(hugo, wilde)
dplyr::intersect(hugo, wilde)
intersect(1:10, 5:15)
2142/33
(2142/33)^(1/17)
1.27^17
1.28^17
1.28*1
1.28*1.28
1.28*1.28*1.28
install.packages("nycflights13")
install.packages("ggmosaic")
install.packages("gapminder")
install.packages("ggplot2movies")
install.packages("ggcorrplot")
install.packages("mice")
tinytex::tlmgr_install(c("beramono","helvet","ifpdf","ifxetex","letterspace","mathpazo"))
tinytex::tlmgr_install("letterspace")
tinytex::tlmgr_install("letterspace", path = T)
tinytex::install_tinytex()
tinytex::tlmgr_install("letterspace")
library(tinytex)
?tlmgr
tlmgr_search("letterspace")
tinytex::tlmgr_install("letterspace.sty")
tinytex::parse_packages(
text = "! LaTeX Error: File `letterspace.sty' not found."
)
tinytex::parse_install(
text = "! LaTeX Error: File `letterspace.sty' not found."
)
tinytex::parse_install(
text = "! LaTeX Error: File `beramono.sty' not found."
)
tinytex::parse_install(
text = "! LaTeX Error: File `ifpdf' not found."
)
tinytex::parse_install(
text = "! LaTeX Error: File `ifpdf.sty' not found."
)
tinytex::parse_install(
text = "! LaTeX Error: File `mathpazo.sty' not found."
)
install.packages("babynames")
install.packages("styler")
